<!-- Admin Users Management with Pico.css -->
<nav class="container-fluid dashboard-nav">
  <ul>
    <li>
      <a href="/" class="logo">
        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
        </svg>
        <strong>My Go SaaS</strong>
      </a>
    </li>
  </ul>
  <ul>
    <li>
      <a href="/admin">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
        </svg>
        Back to Admin
      </a>
    </li>
    <li>
      <!-- Compact Theme Toggle -->
      <button class="theme-toggle-btn" onclick="toggleTheme()" aria-label="Toggle theme">
        <span id="theme-icon"></span>
      </button>
    </li>
  </ul>
</nav>

<main class="container">
  <!-- Page Header -->
  <section>
    <hgroup>
      <h1><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="m22 21-3-3 3-3"/></svg> User Management</h1>
      <p>Manage user accounts, roles, and permissions</p>
    </hgroup>
  </section>

  <!-- Flash Messages -->
  <%= if (flash["success"] && len(flash["success"]) > 0) { %>
    <%= for (msg) in flash["success"] { %>
      <%= if (msg && len(strings.TrimSpace(msg)) > 0) { %>
        <article>
          <p><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12l2 2 4-4"/><circle cx="12" cy="12" r="10"/></svg> <%= msg %></p>
        </article>
      <% } %>
    <% } %>
  <% } %>

  <%= if (flash["danger"] && len(flash["danger"]) > 0) { %>
    <%= for (msg) in flash["danger"] { %>
      <%= if (msg && len(strings.TrimSpace(msg)) > 0) { %>
        <article>
          <p><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg> <%= msg %></p>
        </article>
      <% } %>
    <% } %>
  <% } %>

  <!-- Users Table -->
  <article>
    <header>
      <h3>
        <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="vertical-align: middle; margin-right: 0.5rem;">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
        </svg>
        All Users
      </h3>
    </header>
    
    <%= if (len(users) > 0) { %>
      <figure>
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Role</th>
              <th>Created</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <%= for (user) in users { %>
              <tr>
                <td>
                  <strong><%= user.FirstName %> <%= user.LastName %></strong>
                </td>
                <td><%= user.Email %></td>
                <td>
                  <%= if (user.Role == "admin") { %>
                    <span class="admin-role">
                      <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="vertical-align: middle; margin-right: 0.25rem;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.031 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                      </svg>
                      Admin
                    </span>
                  <% } else { %>
                    <span>
                      <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="vertical-align: middle; margin-right: 0.25rem;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                      </svg>
                      User
                    </span>
                  <% } %>
                </td>
                <td>
                  <small><%= user.CreatedAt.Format("Jan 2, 2006") %></small>
                </td>
                <td>
                  <div class="action-buttons">
                    <a href="/admin/users/<%= user.ID %>" role="button" class="outline">Edit</a>
                    <%= if (user.ID.String() != current_user.ID.String()) { %>
                      <form method="POST" action="/admin/users/<%= user.ID %>" class="inline-form">
                        <input type="hidden" name="_method" value="DELETE">
                        <button type="submit" class="outline" 
                                onclick="return confirm('Are you sure you want to delete this user?')">Delete</button>
                      </form>
                    <% } %>
                  </div>
                </td>
              </tr>
            <% } %>
          </tbody>
        </table>
      </figure>

      <!-- Pagination -->
      <%= if (pagination.TotalPages > 1) { %>
        <footer>
          <nav aria-label="Users pagination">
            <%= if (pagination.Page > 1) { %>
              <a href="?page=<%= pagination.Page - 1 %>" role="button" class="outline">Previous</a>
            <% } %>
            
            <span class="pagination-spacing">
              Page <%= pagination.Page %> of <%= pagination.TotalPages %>
            </span>
            
            <%= if (pagination.Page < pagination.TotalPages) { %>
              <a href="?page=<%= pagination.Page + 1 %>" role="button" class="outline">Next</a>
            <% } %>
          </nav>
        </footer>
      <% } %>
      
    <% } else { %>
      <p>No users found.</p>
    <% } %>
  </article>
</main>
