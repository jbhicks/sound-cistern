<!-- Admin User Edit with Pico.css -->
<nav class="container-fluid dashboard-nav">
  <ul>
    <li>
      <a href="/" class="logo">
        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
        </svg>
        <strong>My Go SaaS</strong>
      </a>
    </li>
  </ul>
  <ul>
    <li>
      <a href="/admin/users">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
        </svg>
        Back to Users
      </a>
    </li>
    <li>
      <!-- Compact Theme Toggle -->
      <button class="theme-toggle-btn" onclick="toggleTheme()" aria-label="Toggle theme">
        <span id="theme-icon"></span>
      </button>
    </li>
  </ul>
</nav>

<main class="container">
  <!-- Page Header -->
  <section>
    <hgroup>
      <h1>
        <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
        </svg>
        Edit User
      </h1>
      <p>Modify user information and role assignments</p>
    </hgroup>
  </section>

  <!-- Flash Messages -->
  <%= if (flash["success"] && len(flash["success"]) > 0) { %>
    <%= for (msg) in flash["success"] { %>
      <%= if (msg && len(strings.TrimSpace(msg)) > 0) { %>
        <article>
          <p><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12l2 2 4-4"/><circle cx="12" cy="12" r="10"/></svg> <%= msg %></p>
        </article>
      <% } %>
    <% } %>
  <% } %>

  <%= if (flash["danger"] && len(flash["danger"]) > 0) { %>
    <%= for (msg) in flash["danger"] { %>
      <%= if (msg && len(strings.TrimSpace(msg)) > 0) { %>
        <article>
          <p><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg> <%= msg %></p>
        </article>
      <% } %>
    <% } %>
  <% } %>

  <!-- Edit User Form -->
  <article>
    <header>
      <h3>
        <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="vertical-align: middle; margin-right: 0.5rem;">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
        </svg>
        User Information
      </h3>
    </header>
    
    <%= formFor(user, {action: "/admin/users/" + user.ID.String(), method: "POST"}) { %>
      <fieldset>
        <label>
          First Name
          <%= f.InputTag("FirstName", {
            type: "text",
            placeholder: "Enter first name",
            required: true
          }) %>
          <%= if (errors && errors["first_name"]) { %>
            <small><%= errors["first_name"] %></small>
          <% } %>
        </label>

        <label>
          Last Name
          <%= f.InputTag("LastName", {
            type: "text",
            placeholder: "Enter last name",
            required: true
          }) %>
          <%= if (errors && errors["last_name"]) { %>
            <small><%= errors["last_name"] %></small>
          <% } %>
        </label>

        <label>
          Email Address
          <%= f.InputTag("Email", {
            type: "email",
            placeholder: "Enter email address",
            required: true
          }) %>
          <%= if (errors && errors["email"]) { %>
            <small><%= errors["email"] %></small>
          <% } %>
        </label>

        <label>
          Role
          <%= f.SelectTag("Role", {
            options: roleOptions,
            value: user.Role,
            required: true
          }) %>
          <%= if (errors && errors["role"]) { %>
            <small><%= errors["role"] %></small>
          <% } %>
          <small><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m21 21-6-6m2-5a7 7 0 1 1-14 0 7 7 0 0 1 14 0z"/><path d="m9 9 5 3-3 5"/></svg> Changing role affects user permissions</small>
        </label>
      </fieldset>

      <fieldset>
        <div class="grid">
          <button type="submit"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17,21 17,13 7,13 7,21"/><polyline points="7,3 7,8 15,8"/></svg> Update User</button>
          <a href="/admin/users" role="button" class="secondary">Cancel</a>
        </div>
      </fieldset>
    <% } %>

    <footer>
      <details>
        <summary>ℹ️ User Details</summary>
        <dl>
          <dt><strong>User ID:</strong></dt>
          <dd><code><%= user.ID %></code></dd>
          <dt><strong>Created:</strong></dt>
          <dd><%= user.CreatedAt.Format("January 2, 2006 at 3:04 PM") %></dd>
          <dt><strong>Last Updated:</strong></dt>
          <dd><%= user.UpdatedAt.Format("January 2, 2006 at 3:04 PM") %></dd>
        </dl>
      </details>
    </footer>
  </article>

  <!-- Danger Zone -->
  <%= if (user.ID != current_user.ID) { %>
    <article>
      <header class="warning-header">
        <h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m21 21-6-6m2-5a7 7 0 1 1-14 0 7 7 0 0 1 14 0z"/><path d="m9 9 5 3-3 5"/></svg> Danger Zone</h3>
      </header>
      <p>Permanently delete this user account and all associated data.</p>
      <footer>
        <form method="POST" action="/admin/users/<%= user.ID %>" class="inline-form">
          <input type="hidden" name="_method" value="DELETE">
          <button type="submit" class="outline" 
                  onclick="return confirm('Are you sure you want to permanently delete this user? This action cannot be undone.')"
                  class="outline contrast">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3,6 5,6 21,6"/><path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"/></svg> Delete User
          </button>
        </form>
      </footer>
    </article>
  <% } %>
</main>
